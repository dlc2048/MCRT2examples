# Example of X-ray imaging
# PMMA Stanford bunny is irradiated by
# 90 kV X-ray source
# 2-D array like track-length estimator is located
# at the opposite.
# 
# geometry build is required before run this code.
# builder command
# > RT2builder -i world.inp
#
# viewer command (condition for viewer.jpg image in example folder)
# > RT2viewer -e 0 0 30
#
# MC run command (X-ray imaging)
# > RT2mc -i mc.inp -o mc.out
#
# The scoring results can be plotted by Python script.
# Python run command
# > python3 plot.py  [Linux]
# > python  plot.py  [Windows]
#
# Attached image file lists
# [xray.png]: The result of X-ray imaging 


CUDA_SETTINGS gpu=0 block_per_sm=128

# 90 kV x-ray spectrum

ENTRY ebin  0.0005	0.001	0.0015	0.002	0.0025  		\
			0.003	0.0035	0.004	0.0045	0.005	0.0055  \
			0.006	0.0065	0.007	0.0075	0.008	0.0085  \
			0.009	0.0095	0.01	0.0105	0.011	0.0115  \
			0.012	0.0125	0.013	0.0135	0.014	0.0145  \
			0.015	0.0155	0.016	0.0165	0.017	0.0175  \
			0.018	0.0185	0.019	0.0195	0.02	0.0205  \
			0.021	0.0215	0.022	0.0225	0.023	0.0235  \
			0.024	0.0245	0.025	0.0255	0.026	0.0265  \
			0.027	0.0275	0.028	0.0285	0.029	0.0295  \
			0.03	0.0305	0.031	0.0315	0.032	0.0325  \
			0.033	0.0335	0.034	0.0345	0.035	0.0355  \
			0.036	0.0365	0.037	0.0375	0.038	0.0385  \
			0.039	0.0395	0.04	0.0405	0.041	0.0415  \
			0.042	0.0425	0.043	0.0435	0.044	0.0445  \
			0.045	0.0455	0.046	0.0465	0.047	0.0475  \
			0.048	0.0485	0.049	0.0495	0.05	0.0505  \
			0.051	0.0515	0.052	0.0525	0.053	0.0535  \
			0.054	0.0545	0.055	0.0555	0.056	0.0565  \
			0.057	0.0575	0.058	0.0585	0.059	0.0595  \
			0.06	0.0605	0.061	0.0615	0.062	0.0625  \
			0.063	0.0635	0.064	0.0645	0.065	0.0655  \
			0.066	0.0665	0.067	0.0675	0.068	0.0685  \
			0.069	0.0695	0.07	0.0705	0.071	0.0715  \
			0.072	0.0725	0.073	0.0735	0.074	0.0745  \
			0.075	0.0755	0.076	0.0765	0.077	0.0775  \
			0.078	0.0785	0.079	0.0795	0.08	0.0805  \
			0.081	0.0815	0.082	0.0825	0.083	0.0835  \
			0.084	0.0845	0.085	0.0855	0.086	0.0865  \
			0.087	0.0875	0.088	0.0885	0.089	0.0895  \
			0.09			

ENTRY eprob 1e-30		0.192031503	1e-30		0.00161371	1e-30            \
			1e-30		0.00161371	1e-30		1e-30		1e-30		0.00161371    \
			1e-30		0.00322742	0.00161371	0.00161371	0.00322742	0.00968226    \
			0.035501622	0.238829076	0.306604892	0.445383966	1.192531705	1.555616498   \
			2.202714205	3.613096952	5.702851295	8.502637863	11.83817577	15.81597137   \
			19.88413429	25.06414413	30.37970734	35.34186554	40.70422363	46.18760681   \
			51.31114197	56.54924011	61.06117249	66.0717392	70.59174347	74.47110748   \
			77.61945343	81.87802887	84.43253326	87.9778595	89.85782623	91.57965851   \
			93.67910004	95.26859283	96.23036957	97.55522919	99.15118408	99.0124054    \
			99.00756836	99.16893005	100			99.16247559	98.90266418	98.62834167   \
			98.48956299	98.15391541	96.35784912	96.81937408	95.91246796	94.69089508   \
			93.78398132	91.83300781	91.10845184	90.36131287	89.3898468	89.12358856   \
			87.46146393	85.58149719	85.42334747	83.25775146	82.23950195	81.46492004   \
			81.34066772	79.29125214	77.80825806	76.99172211	75.62167358	74.69379425   \
			73.47383118	72.97519684	71.42765045	69.87364197	68.6811142	67.63703918   \
			67.02544403	66.54940033	64.89373779	63.49142075	62.73459244	61.12088394   \
			61.18058395	59.37807083	58.44535065	57.06401062	56.80259323	55.68267822   \
			55.18242645	53.89953232	53.11849213	52.28743744	50.72375107	49.81361771   \
			49.21493149	48.20797348	47.69481277	46.65881348	45.67605972	44.9353714    \
			44.5642128	43.47657394	54.38364029	41.65147018	60.81911469	40.49443817   \
			39.11471939	38.59994507	37.93670654	36.93620682	36.41659164	35.48064423   \
			35.10787582	33.97021103	33.52805328	32.73572159	32.29679108	31.30435944   \
			30.83315849	30.35711288	35.47418594	29.04839516	27.93170738	27.86231613   \
			28.30124855	26.59878349	24.4267292	23.46818542	22.77106285	22.45316124   \
			22.23208237	21.05245972	20.55705261	19.83411026	19.59850883	19.19992065   \
			18.59477997	18.20103455	17.55555153	16.6196003	16.49373055	15.94829559   \
			15.54002762	14.83644962	14.21033096	13.84885883	13.406703	13.07589245   \
			12.23353577	11.80751514	11.24594498	10.77474117	10.20026112	9.38533783    \
			9.143280983	8.378382683	7.824879646	7.490841866	6.480659485	5.589891434   \
			5.312333107	4.353789806	3.385563612	2.681986094	1.621778727	0.640642881
			
ENTRY dbin  1
ENTRY dprob 1

ELECTRON       use_presta2=1 transport_cutoff=0.001 production_cutoff=0.389161 estepe=0.06
PHOTON         transport_cutoff=0.001 production_cutoff=0.002777 library=epdl97
VACANCY        transport_cutoff=0.001 production_cutoff=0.001

COMPOUND vacuum     0.0
COMPOUND hydrogen   0.08988  101  99.9855   1002  0.0145
COMPOUND carbon     2.4      6012   100.0
COMPOUND oxygen     0.001    8016    99.8   8017     0.2

COMPOUND pmma       1.19    hydrogen -8  carbon -5  oxygen  -2

ASSIGN region=target compound=pmma
ASSIGN region=void   compound=vacuum

BEAM_GLOBAL mode=macro nps=1e10

BEAM_CUBIC    name=beam             \
              pid=0                 \
              position=0,0,10       \ 
              size=20,20,0          \
              type=linear           \
              weight=1              \
              direction=0,0,-1      \
              energy=ebin,eprob     \
              divergence=dbin,dprob
			  
MESH_TRACK   name=image pid=0 xrange=-10,10 yrange=-10,10 zrange=-10.01,-9.99 \
             nx=1000  ny=1000  nz=1  escale=linear  erange=0.,1.  ne=1
 
DENSITY name=tdepo1 pid=0  where=target type=depo volume=1
DENSITY name=tdepo2 pid=-1 where=target type=depo volume=1
DENSITY name=tdepo3 pid=+1 where=target type=depo volume=1